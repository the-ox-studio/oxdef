
> oxdefinition@0.1.0 test
> node --test test/**/*.test.js

TAP version 13
# Subtest: Transaction
    # Subtest: creates transaction with variables
    ok 1 - creates transaction with variables
      ---
      duration_ms: 2.3624
      ...
    # Subtest: creates transaction with functions
    ok 2 - creates transaction with functions
      ---
      duration_ms: 0.3717
      ...
    # Subtest: adds and retrieves data sources
    ok 3 - adds and retrieves data sources
      ---
      duration_ms: 0.2874
      ...
    # Subtest: supports data source wrappers with transaction access
    ok 4 - supports data source wrappers with transaction access
      ---
      duration_ms: 0.306
      ...
    # Subtest: fetches data source successfully
    ok 5 - fetches data source successfully
      ---
      duration_ms: 0.4702
      ...
    # Subtest: caches data source results
    ok 6 - caches data source results
      ---
      duration_ms: 0.2596
      ...
    # Subtest: handles data source timeout
    ok 7 - handles data source timeout
      ---
      duration_ms: 102.7945
      ...
    # Subtest: captures data source errors
    ok 8 - captures data source errors
      ---
      duration_ms: 0.583
      ...
    # Subtest: fetches multiple data sources in parallel
    ok 9 - fetches multiple data sources in parallel
      ---
      duration_ms: 10.7607
      ...
    # Subtest: handles mixed success and failure in parallel fetch
    ok 10 - handles mixed success and failure in parallel fetch
      ---
      duration_ms: 0.8367
      ...
    # Subtest: clones transaction
    ok 11 - clones transaction
      ---
      duration_ms: 0.3353
      ...
    # Subtest: clears data source cache
    ok 12 - clears data source cache
      ---
      duration_ms: 0.3961
      ...
    1..12
ok 1 - Transaction
  ---
  duration_ms: 122.0127
  type: 'suite'
  ...
# Subtest: DataSourceProcessor
    # Subtest: detects simple data source in AST
    ok 1 - detects simple data source in AST
      ---
      duration_ms: 1.7328
      ...
    # Subtest: detects nested data sources
    ok 2 - detects nested data sources
      ---
      duration_ms: 0.2788
      ...
    # Subtest: detects parallel data sources
    ok 3 - detects parallel data sources
      ---
      duration_ms: 0.2034
      ...
    # Subtest: validates data sources exist in transaction
    ok 4 - validates data sources exist in transaction
      ---
      duration_ms: 0.5907
      ...
    # Subtest: creates execution plan for parallel sources
    ok 5 - creates execution plan for parallel sources
      ---
      duration_ms: 0.3556
      ...
    # Subtest: creates execution plan for nested sources
    ok 6 - creates execution plan for nested sources
      ---
      duration_ms: 0.3017
      ...
    # Subtest: executes data sources according to plan
    ok 7 - executes data sources according to plan
      ---
      duration_ms: 0.4537
      ...
    # Subtest: executes nested data sources in order
    ok 8 - executes nested data sources in order
      ---
      duration_ms: 13.4079
      ...
    # Subtest: tracks successful and failed data sources
    ok 9 - tracks successful and failed data sources
      ---
      duration_ms: 0.5043
      ...
    # Subtest: retrieves data source results
    ok 10 - retrieves data source results
      ---
      duration_ms: 0.2539
      ...
    # Subtest: retrieves data source errors
    ok 11 - retrieves data source errors
      ---
      duration_ms: 0.3003
      ...
    1..11
ok 2 - DataSourceProcessor
  ---
  duration_ms: 18.7202
  type: 'suite'
  ...
# Subtest: ExpressionEvaluator - Literals
    # Subtest: evaluates number literals
    ok 1 - evaluates number literals
      ---
      duration_ms: 1.4663
      ...
    # Subtest: evaluates string literals
    ok 2 - evaluates string literals
      ---
      duration_ms: 1.1539
      ...
    # Subtest: evaluates boolean literals
    ok 3 - evaluates boolean literals
      ---
      duration_ms: 0.2178
      ...
    # Subtest: evaluates null literal
    ok 4 - evaluates null literal
      ---
      duration_ms: 0.159
      ...
    1..4
ok 3 - ExpressionEvaluator - Literals
  ---
  duration_ms: 4.4668
  type: 'suite'
  ...
# Subtest: ExpressionEvaluator - Variables
    # Subtest: evaluates simple variable reference
    ok 1 - evaluates simple variable reference
      ---
      duration_ms: 1.9641
      ...
    # Subtest: evaluates member access
    ok 2 - evaluates member access
      ---
      duration_ms: 0.3581
      ...
    # Subtest: evaluates nested member access
    ok 3 - evaluates nested member access
      ---
      duration_ms: 0.4706
      ...
    # Subtest: throws on undefined variable
    ok 4 - throws on undefined variable
      ---
      duration_ms: 0.8757
      ...
    # Subtest: throws on null property access
    ok 5 - throws on null property access
      ---
      duration_ms: 0.4811
      ...
    1..5
ok 4 - ExpressionEvaluator - Variables
  ---
  duration_ms: 4.7542
  type: 'suite'
  ...
# Subtest: ExpressionEvaluator - Arithmetic
    # Subtest: evaluates addition
    ok 1 - evaluates addition
      ---
      duration_ms: 0.5486
      ...
    # Subtest: evaluates subtraction
    ok 2 - evaluates subtraction
      ---
      duration_ms: 0.1566
      ...
    # Subtest: evaluates multiplication
    ok 3 - evaluates multiplication
      ---
      duration_ms: 0.1453
      ...
    # Subtest: evaluates division
    ok 4 - evaluates division
      ---
      duration_ms: 0.1485
      ...
    # Subtest: evaluates modulo
    ok 5 - evaluates modulo
      ---
      duration_ms: 0.1309
      ...
    # Subtest: evaluates exponentiation
    ok 6 - evaluates exponentiation
      ---
      duration_ms: 0.1402
      ...
    # Subtest: respects operator precedence
    ok 7 - respects operator precedence
      ---
      duration_ms: 0.1268
      ...
    # Subtest: handles parentheses
    ok 8 - handles parentheses
      ---
      duration_ms: 0.1343
      ...
    # Subtest: evaluates unary minus
    ok 9 - evaluates unary minus
      ---
      duration_ms: 0.1178
      ...
    # Subtest: evaluates complex expression
    ok 10 - evaluates complex expression
      ---
      duration_ms: 0.2114
      ...
    1..10
ok 5 - ExpressionEvaluator - Arithmetic
  ---
  duration_ms: 2.1882
  type: 'suite'
  ...
# Subtest: ExpressionEvaluator - Comparison
    # Subtest: evaluates equality
    ok 1 - evaluates equality
      ---
      duration_ms: 0.3227
      ...
    # Subtest: evaluates inequality
    ok 2 - evaluates inequality
      ---
      duration_ms: 0.1606
      ...
    # Subtest: evaluates less than
    ok 3 - evaluates less than
      ---
      duration_ms: 0.154
      ...
    # Subtest: evaluates greater than
    ok 4 - evaluates greater than
      ---
      duration_ms: 0.2372
      ...
    # Subtest: evaluates less than or equal
    ok 5 - evaluates less than or equal
      ---
      duration_ms: 0.1562
      ...
    # Subtest: evaluates greater than or equal
    ok 6 - evaluates greater than or equal
      ---
      duration_ms: 0.1294
      ...
    1..6
ok 6 - ExpressionEvaluator - Comparison
  ---
  duration_ms: 1.3958
  type: 'suite'
  ...
# Subtest: ExpressionEvaluator - Logical
    # Subtest: evaluates logical AND
    ok 1 - evaluates logical AND
      ---
      duration_ms: 0.2285
      ...
    # Subtest: evaluates logical OR
    ok 2 - evaluates logical OR
      ---
      duration_ms: 0.1079
      ...
    # Subtest: evaluates logical NOT
    ok 3 - evaluates logical NOT
      ---
      duration_ms: 0.1066
      ...
    # Subtest: evaluates complex logical expression
    ok 4 - evaluates complex logical expression
      ---
      duration_ms: 0.1284
      ...
    1..4
ok 7 - ExpressionEvaluator - Logical
  ---
  duration_ms: 1.2524
  type: 'suite'
  ...
# Subtest: ExpressionEvaluator - Mixed Expressions
    # Subtest: evaluates expression with variables
    ok 1 - evaluates expression with variables
      ---
      duration_ms: 0.2314
      ...
    # Subtest: evaluates comparison with variables
    ok 2 - evaluates comparison with variables
      ---
      duration_ms: 0.1085
      ...
    # Subtest: evaluates complex condition
    ok 3 - evaluates complex condition
      ---
      duration_ms: 0.0965
      ...
    1..3
ok 8 - ExpressionEvaluator - Mixed Expressions
  ---
  duration_ms: 0.5256
  type: 'suite'
  ...
# Subtest: Free Text Blocks
    # Subtest: Lexer
        # Subtest: should tokenize simple free text block
        ok 1 - should tokenize simple free text block
          ---
          duration_ms: 2.2417
          ...
        # Subtest: should tokenize empty free text block
        not ok 2 - should tokenize empty free text block
          ---
          duration_ms: 0.2703
          location: 'C:\\Dev\\Desinda.Dev\\Tools\\OX Studio\\oxdef\\test\\free-text.test.js:18:5'
          failureType: 'testCodeFailure'
          error: 'Unterminated free text block starting at 1:1 (expected 6 backticks)'
          code: 'ERR_TEST_FAILURE'
          name: 'ParseError'
          stack: |-
            Tokenizer.error (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:178:12)
            Tokenizer.readFreeTextBlock (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:330:18)
            Tokenizer.nextToken (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:442:21)
            Tokenizer.tokenize (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:549:26)
            tokenize (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:578:20)
            TestContext.<anonymous> (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/test/free-text.test.js:20:22)
            Test.runInAsyncScope (node:async_hooks:211:14)
            Test.run (node:internal/test_runner/test:979:25)
            Suite.processPendingSubtests (node:internal/test_runner/test:677:18)
            Test.postRun (node:internal/test_runner/test:1090:19)
          ...
        # Subtest: should tokenize free text with newlines
        ok 3 - should tokenize free text with newlines
          ---
          duration_ms: 0.2329
          ...
        # Subtest: should support four backticks for escaping
        ok 4 - should support four backticks for escaping
          ---
          duration_ms: 0.1646
          ...
        # Subtest: should throw error on unclosed free text block
        ok 5 - should throw error on unclosed free text block
          ---
          duration_ms: 0.3689
          ...
        # Subtest: should throw error on less than 3 backticks
        ok 6 - should throw error on less than 3 backticks
          ---
          duration_ms: 0.1985
          ...
        1..6
    not ok 1 - Lexer
      ---
      duration_ms: 4.5784
      type: 'suite'
      location: 'C:\\Dev\\Desinda.Dev\\Tools\\OX Studio\\oxdef\\test\\free-text.test.js:8:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        async Promise.all (index 0)
      ...
    # Subtest: Parser - Basic
        # Subtest: should parse free text as child of block
        ok 1 - should parse free text as child of block
          ---
          duration_ms: 1.7498
          ...
        # Subtest: should parse multiple free text blocks (merged)
        ok 2 - should parse multiple free text blocks (merged)
          ---
          duration_ms: 0.8276
          ...
        # Subtest: should parse free text with tags
        ok 3 - should parse free text with tags
          ---
          duration_ms: 0.6108
          ...
        # Subtest: should parse free text with multiple tags
        ok 4 - should parse free text with multiple tags
          ---
          duration_ms: 0.4974
          ...
        # Subtest: should parse empty free text block
        not ok 5 - should parse empty free text block
          ---
          duration_ms: 0.2065
          location: 'C:\\Dev\\Desinda.Dev\\Tools\\OX Studio\\oxdef\\test\\free-text.test.js:107:5'
          failureType: 'testCodeFailure'
          error: 'Unterminated free text block starting at 2:1 (expected 6 backticks)'
          code: 'ERR_TEST_FAILURE'
          name: 'ParseError'
          stack: |-
            Tokenizer.error (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:178:12)
            Tokenizer.readFreeTextBlock (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:330:18)
            Tokenizer.nextToken (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:442:21)
            Tokenizer.tokenize (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:549:26)
            tokenize (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/src/lexer/tokenizer.js:578:20)
            TestContext.<anonymous> (file:///C:/Dev/Desinda.Dev/Tools/OX%20Studio/oxdef/test/free-text.test.js:109:22)
            Test.runInAsyncScope (node:async_hooks:211:14)
            Test.run (node:internal/test_runner/test:979:25)
            Suite.processPendingSubtests (node:internal/test_runner/test:677:18)
            Test.postRun (node:internal/test_runner/test:1090:19)
          ...
        # Subtest: should parse mixed content
        ok 6 - should parse mixed content
          ---
          duration_ms: 0.4044
          ...
        1..6
    not ok 2 - Parser - Basic
      ---
      duration_ms: 4.8575
      type: 'suite'
      location: 'C:\\Dev\\Desinda.Dev\\Tools\\OX Studio\\oxdef\\test\\free-text.test.js:58:3'
      failureType: 'subtestsFailed'
      error: '1 subtest failed'
      code: 'ERR_TEST_FAILURE'
      ...
    # Subtest: Whitespace Processing
        # Subtest: should trim leading and trailing newlines
        ok 1 - should trim leading and trailing newlines
          ---
          duration_ms: 0.2889
          ...
        # Subtest: should remove common indentation
        ok 2 - should remove common indentation
          ---
          duration_ms: 0.2452
          ...
        # Subtest: should preserve relative indentation
        ok 3 - should preserve relative indentation
          ---
          duration_ms: 0.1377
          ...
        # Subtest: should handle empty lines
        ok 4 - should handle empty lines
          ---
          duration_ms: 0.113
          ...
        # Subtest: should return empty string for empty input
        ok 5 - should return empty string for empty input
          ---
          duration_ms: 0.126
          ...
        # Subtest: should handle tabs (convert to 4 spaces)
        ok 6 - should handle tabs (convert to 4 spaces)
          ---
          duration_ms: 0.1349
          ...
        # Subtest: should work with code indentation
        ok 7 - should work with code indentation
          ---
          duration_ms: 0.111
          ...
        1..7
    ok 3 - Whitespace Processing
      ---
      duration_ms: 1.4196
      type: 'suite'
      ...
    # Subtest: Block Merging
        # Subtest: should merge adjacent untagged free text blocks
        ok 1 - should merge adjacent untagged free text blocks
          ---
          duration_ms: 0.3156
          ...
        # Subtest: should merge blocks with identical tags
        ok 2 - should merge blocks with identical tags
          ---
          duration_ms: 0.3087
          ...
        # Subtest: should not merge blocks with different tags
        ok 3 - should not merge blocks with different tags
          ---
          duration_ms: 0.2119
          ...
        # Subtest: should not merge when intervening content exists
        ok 4 - should not merge when intervening content exists
          ---
          duration_ms: 1.0371
          ...
        # Subtest: should respect mergeFreeText: false option
        ok 5 - should respect mergeFreeText: false option
          ---
          duration_ms: 0.1978
          ...
        1..5
    ok 4 - Block Merging
      ---
      duration_ms: 2.3518
      type: 'suite'
      ...
    # Subtest: Edge Cases
        # Subtest: should handle free text with special characters
        ok 1 - should handle free text with special characters
          ---
          duration_ms: 0.2509
          ...
        # Subtest: should handle free text with quotes
        ok 2 - should handle free text with quotes
          ---
          duration_ms: 0.1885
          ...
        # Subtest: should handle unicode content
        ok 3 - should handle unicode content
          ---
          duration_ms: 0.2448
          ...
        1..3
    ok 5 - Edge Cases
      ---
      duration_ms: 0.8414
      type: 'suite'
      ...
    1..5
not ok 9 - Free Text Blocks
  ---
  duration_ms: 15.0155
  type: 'suite'
  location: 'C:\\Dev\\Desinda.Dev\\Tools\\OX Studio\\oxdef\\test\\free-text.test.js:7:1'
  failureType: 'subtestsFailed'
  error: '2 subtests failed'
  code: 'ERR_TEST_FAILURE'
  ...
# Subtest: Tokenizer
    # Subtest: tokenizes simple block
    ok 1 - tokenizes simple block
      ---
      duration_ms: 2.1464
      ...
    # Subtest: tokenizes block with properties
    ok 2 - tokenizes block with properties
      ---
      duration_ms: 0.5294
      ...
    # Subtest: tokenizes strings
    ok 3 - tokenizes strings
      ---
      duration_ms: 0.3974
      ...
    # Subtest: tokenizes escape sequences in strings
    ok 4 - tokenizes escape sequences in strings
      ---
      duration_ms: 0.1878
      ...
    # Subtest: tokenizes numbers
    ok 5 - tokenizes numbers
      ---
      duration_ms: 0.2996
      ...
    # Subtest: tokenizes booleans
    ok 6 - tokenizes booleans
      ---
      duration_ms: 0.1431
      ...
    # Subtest: tokenizes null
    ok 7 - tokenizes null
      ---
      duration_ms: 0.1513
      ...
    # Subtest: tokenizes arrays
    ok 8 - tokenizes arrays
      ---
      duration_ms: 0.2903
      ...
    # Subtest: tokenizes operators
    ok 9 - tokenizes operators
      ---
      duration_ms: 0.4529
      ...
    # Subtest: tokenizes references
    ok 10 - tokenizes references
      ---
      duration_ms: 0.5068
      ...
    # Subtest: tokenizes tags
    ok 11 - tokenizes tags
      ---
      duration_ms: 0.2114
      ...
    # Subtest: tokenizes template markers
    ok 12 - tokenizes template markers
      ---
      duration_ms: 0.2039
      ...
    # Subtest: skips line comments
    ok 13 - skips line comments
      ---
      duration_ms: 0.2177
      ...
    # Subtest: skips block comments
    ok 14 - skips block comments
      ---
      duration_ms: 0.2064
      ...
    # Subtest: tracks line and column numbers
    ok 15 - tracks line and column numbers
      ---
      duration_ms: 0.1317
      ...
    # Subtest: throws error on unterminated string
    ok 16 - throws error on unterminated string
      ---
      duration_ms: 0.6559
      ...
    # Subtest: throws error on invalid character
    ok 17 - throws error on invalid character
      ---
      duration_ms: 0.1887
      ...
    # Subtest: tokenizes complex nested structure
    ok 18 - tokenizes complex nested structure
      ---
      duration_ms: 0.2886
      ...
    1..18
ok 10 - Tokenizer
  ---
  duration_ms: 9.992
  type: 'suite'
  ...
# Subtest: Milestone 1: Pre-Parse Hook - Basic Execution
    # Subtest: onParse callback executes before preprocessing
    ok 1 - onParse callback executes before preprocessing
      ---
      duration_ms: 2.3773
      ...
    # Subtest: onParse callback has access to ctx object
    ok 2 - onParse callback has access to ctx object
      ---
      duration_ms: 0.3661
      ...
    1..2
ok 11 - Milestone 1: Pre-Parse Hook - Basic Execution
  ---
  duration_ms: 4.0137
  type: 'suite'
  ...
# Subtest: Milestone 1: Tree Access and Walking
    # Subtest: ctx.tree provides access to parsed AST
    ok 1 - ctx.tree provides access to parsed AST
      ---
      duration_ms: 0.8081
      ...
    # Subtest: ctx.walk() traverses tree structure
    ok 2 - ctx.walk() traverses tree structure
      ---
      duration_ms: 1.4953
      ...
    # Subtest: ctx.walk() provides parent context
    ok 3 - ctx.walk() provides parent context
      ---
      duration_ms: 0.4941
      ...
    1..3
ok 12 - Milestone 1: Tree Access and Walking
  ---
  duration_ms: 3.164
  type: 'suite'
  ...
# Subtest: Milestone 1: Early Termination
    # Subtest: ctx.finish() terminates preprocessing early
    ok 1 - ctx.finish() terminates preprocessing early
      ---
      duration_ms: 0.6157
      ...
    # Subtest: finish() prevents further processing
    ok 2 - finish() prevents further processing
      ---
      duration_ms: 0.4468
      ...
    1..2
ok 13 - Milestone 1: Early Termination
  ---
  duration_ms: 1.4607
  type: 'suite'
  ...
# Subtest: Milestone 1: Raw AST Access
    # Subtest: access raw templates from tree
    ok 1 - access raw templates from tree
      ---
      duration_ms: 0.8004
      ...
    # Subtest: access raw expressions in properties
    ok 2 - access raw expressions in properties
      ---
      duration_ms: 0.7176
      ...
    # Subtest: inspect tags in raw tree
    ok 3 - inspect tags in raw tree
      ---
      duration_ms: 0.8778
      ...
    1..3
ok 14 - Milestone 1: Raw AST Access
  ---
  duration_ms: 2.7163
  type: 'suite'
  ...
# Subtest: Milestone 1: Error Handling
    # Subtest: MacroError is thrown for validation failures
    ok 1 - MacroError is thrown for validation failures
      ---
      duration_ms: 0.8626
      ...
    # Subtest: user errors in onParse are caught and wrapped
    ok 2 - user errors in onParse are caught and wrapped
      ---
      duration_ms: 0.2782
      ...
    1..2
ok 15 - Milestone 1: Error Handling
  ---
  duration_ms: 1.3539
  type: 'suite'
  ...
# Subtest: Milestone 1: Use Cases
    # Subtest: Use case: Code generation - collect component definitions
    ok 1 - Use case: Code generation - collect component definitions
      ---
      duration_ms: 0.7494
      ...
    # Subtest: Use case: Static analysis - validate block structure
    ok 2 - Use case: Static analysis - validate block structure
      ---
      duration_ms: 0.4431
      ...
    # Subtest: Use case: Conditional processing based on analysis
    ok 3 - Use case: Conditional processing based on analysis
      ---
      duration_ms: 0.3457
      ...
    1..3
ok 16 - Milestone 1: Use Cases
  ---
  duration_ms: 1.7155
  type: 'suite'
  ...
# Subtest: Milestone 1: Integration Tests
    # Subtest: complex document analysis with multiple features
    ok 1 - complex document analysis with multiple features
      ---
      duration_ms: 1.5937
      ...
    # Subtest: parseWithMacros works without macro context
    ok 2 - parseWithMacros works without macro context
      ---
      duration_ms: 0.1678
      ...
    # Subtest: parseWithMacros works with empty onParse
    ok 3 - parseWithMacros works with empty onParse
      ---
      duration_ms: 0.1471
      ...
    # Subtest: multiple walk calls in onParse
    ok 4 - multiple walk calls in onParse
      ---
      duration_ms: 0.3773
      ...
    # Subtest: tree structure after onParse remains unchanged
    ok 5 - tree structure after onParse remains unchanged
      ---
      duration_ms: 0.2581
      ...
    1..5
ok 17 - Milestone 1: Integration Tests
  ---
  duration_ms: 2.7575
  type: 'suite'
  ...
# Subtest: Milestone 2: Macro Walk Hook - Basic Execution
    # Subtest: onWalk called for each block during preprocessing
    ok 1 - onWalk called for each block during preprocessing
      ---
      duration_ms: 5.3375
      ...
    # Subtest: onWalk receives block and parent parameters
    ok 2 - onWalk receives block and parent parameters
      ---
      duration_ms: 1.6075
      ...
    # Subtest: onWalk called in correct order (parent before children)
    ok 3 - onWalk called in correct order (parent before children)
      ---
      duration_ms: 0.9036
      ...
    1..3
ok 18 - Milestone 2: Macro Walk Hook - Basic Execution
  ---
  duration_ms: 9.176
  type: 'suite'
  ...
# Subtest: Milestone 2: Property Evaluation Guarantees
    # Subtest: block properties are literals (evaluated) in onWalk
    ok 1 - block properties are literals (evaluated) in onWalk
      ---
      duration_ms: 0.7885
      ...
    # Subtest: children properties are still expressions in onWalk
    ok 2 - children properties are still expressions in onWalk
      ---
      duration_ms: 0.7785
      ...
    # Subtest: expressions without $ are evaluated before onWalk
    ok 3 - expressions without $ are evaluated before onWalk
      ---
      duration_ms: 0.8656
      ...
    # Subtest: module properties are available in onWalk
    ok 4 - module properties are available in onWalk
      ---
      duration_ms: 0.7199
      ...
    1..4
ok 19 - Milestone 2: Property Evaluation Guarantees
  ---
  duration_ms: 3.7566
  type: 'suite'
  ...
# Subtest: Milestone 2: Auto-processing
    # Subtest: children auto-expand after onWalk returns
    ok 1 - children auto-expand after onWalk returns
      ---
      duration_ms: 0.5598
      ...
    # Subtest: children become available with evaluated properties
    ok 2 - children become available with evaluated properties
      ---
      duration_ms: 0.8102
      ...
    # Subtest: nested blocks all process correctly
    ok 3 - nested blocks all process correctly
      ---
      duration_ms: 1.2444
      ...
    1..3
ok 20 - Milestone 2: Auto-processing
  ---
  duration_ms: 2.9557
  type: 'suite'
  ...
# Subtest: Milestone 2: Property Modification
    # Subtest: can modify block properties in onWalk
    ok 1 - can modify block properties in onWalk
      ---
      duration_ms: 0.3462
      ...
    # Subtest: can add new properties in onWalk
    ok 2 - can add new properties in onWalk
      ---
      duration_ms: 0.236
      ...
    1..2
ok 21 - Milestone 2: Property Modification
  ---
  duration_ms: 0.7144
  type: 'suite'
  ...
# Subtest: Milestone 2: Validation
    # Subtest: can validate required properties with throwError
    ok 1 - can validate required properties with throwError
      ---
      duration_ms: 0.7561
      ...
    # Subtest: can set default values for missing properties
    ok 2 - can set default values for missing properties
      ---
      duration_ms: 0.3217
      ...
    1..2
ok 22 - Milestone 2: Validation
  ---
  duration_ms: 1.2733
  type: 'suite'
  ...
# Subtest: Milestone 2: Integration
    # Subtest: onWalk works with templates (if, foreach)
    ok 1 - onWalk works with templates (if, foreach)
      ---
      duration_ms: 1.7353
      ...
    # Subtest: onWalk works with reference resolution
    ok 2 - onWalk works with reference resolution
      ---
      duration_ms: 0.7837
      ...
    1..2
ok 23 - Milestone 2: Integration
  ---
  duration_ms: 2.6777
  type: 'suite'
  ...
# Subtest: Milestone 2: Error Handling
    # Subtest: user errors in onWalk are caught and wrapped
    ok 1 - user errors in onWalk are caught and wrapped
      ---
      duration_ms: 0.3291
      ...
    # Subtest: MacroError in onWalk is re-thrown without wrapping
    ok 2 - MacroError in onWalk is re-thrown without wrapping
      ---
      duration_ms: 0.219
      ...
    1..2
ok 24 - Milestone 2: Error Handling
  ---
  duration_ms: 0.667
  type: 'suite'
  ...
# Subtest: Milestone 2: Advanced Use Cases
    # Subtest: track and validate parent-child relationships
    ok 1 - track and validate parent-child relationships
      ---
      duration_ms: 0.5352
      ...
    # Subtest: accumulate properties from ancestors
    ok 2 - accumulate properties from ancestors
      ---
      duration_ms: 0.2899
      ...
    # Subtest: collect block metadata during preprocessing
    ok 3 - collect block metadata during preprocessing
      ---
      duration_ms: 0.593
      ...
    # Subtest: onWalk without macro context works normally
    ok 4 - onWalk without macro context works normally
      ---
      duration_ms: 0.1829
      ...
    # Subtest: empty onWalk callback still processes correctly
    ok 5 - empty onWalk callback still processes correctly
      ---
      duration_ms: 0.261
      ...
    # Subtest: complex property transformations in onWalk
    ok 6 - complex property transformations in onWalk
      ---
      duration_ms: 0.2812
      ...
    1..6
ok 25 - Milestone 2: Advanced Use Cases
  ---
  duration_ms: 2.379
  type: 'suite'
  ...
# Subtest: Parser
    # Subtest: parses simple block
    ok 1 - parses simple block
      ---
      duration_ms: 3.4698
      ...
    # Subtest: parses block with properties
    ok 2 - parses block with properties
      ---
      duration_ms: 0.9195
      ...
    # Subtest: parses block with string properties
    ok 3 - parses block with string properties
      ---
      duration_ms: 0.3771
      ...
    # Subtest: parses nested blocks
    ok 4 - parses nested blocks
      ---
      duration_ms: 0.4641
      ...
    # Subtest: parses array properties
    ok 5 - parses array properties
      ---
      duration_ms: 0.851
      ...
    # Subtest: parses expression properties
    ok 6 - parses expression properties
      ---
      duration_ms: 1.2536
      ...
    # Subtest: parses tags on blocks
    ok 7 - parses tags on blocks
      ---
      duration_ms: 0.3763
      ...
    # Subtest: parses tags with arguments
    ok 8 - parses tags with arguments
      ---
      duration_ms: 0.3664
      ...
    # Subtest: parses multiple tags
    ok 9 - parses multiple tags
      ---
      duration_ms: 0.6004
      ...
    # Subtest: parses set template
    ok 10 - parses set template
      ---
      duration_ms: 0.8667
      ...
    # Subtest: parses if template
    ok 11 - parses if template
      ---
      duration_ms: 0.5694
      ...
    # Subtest: parses if-else template
    ok 12 - parses if-else template
      ---
      duration_ms: 0.2311
      ...
    # Subtest: parses if-elseif-else template
    ok 13 - parses if-elseif-else template
      ---
      duration_ms: 0.2556
      ...
    # Subtest: parses foreach template
    ok 14 - parses foreach template
      ---
      duration_ms: 0.4302
      ...
    # Subtest: parses foreach with index
    ok 15 - parses foreach with index
      ---
      duration_ms: 0.1804
      ...
    # Subtest: parses while template
    ok 16 - parses while template
      ---
      duration_ms: 0.3327
      ...
    # Subtest: parses on-data template
    ok 17 - parses on-data template
      ---
      duration_ms: 0.3439
      ...
    # Subtest: parses on-data with error handling
    ok 18 - parses on-data with error handling
      ---
      duration_ms: 0.1778
      ...
    # Subtest: parses import statement
    ok 19 - parses import statement
      ---
      duration_ms: 0.2604
      ...
    # Subtest: parses import with alias
    ok 20 - parses import with alias
      ---
      duration_ms: 0.2025
      ...
    # Subtest: parses complex document
    ok 21 - parses complex document
      ---
      duration_ms: 0.6737
      ...
    # Subtest: throws error on unclosed block
    ok 22 - throws error on unclosed block
      ---
      duration_ms: 0.6857
      ...
    # Subtest: throws error on missing block identifier
    ok 23 - throws error on missing block identifier
      ---
      duration_ms: 0.2157
      ...
    # Subtest: throws error on unclosed if
    ok 24 - throws error on unclosed if
      ---
      duration_ms: 0.2147
      ...
    # Subtest: throws error on mismatched closing tag
    ok 25 - throws error on mismatched closing tag
      ---
      duration_ms: 0.1662
      ...
    1..25
ok 26 - Parser
  ---
  duration_ms: 18.014
  type: 'suite'
  ...
# Subtest: BlockRegistry
    # Subtest: should register a block
    ok 1 - should register a block
      ---
      duration_ms: 2.3726
      ...
    # Subtest: should track parent-child relationships
    ok 2 - should track parent-child relationships
      ---
      duration_ms: 0.263
      ...
    # Subtest: should build siblings after registration
    ok 3 - should build siblings after registration
      ---
      duration_ms: 1.3318
      ...
    # Subtest: should find sibling by ID
    ok 4 - should find sibling by ID
      ---
      duration_ms: 0.3879
      ...
    # Subtest: should return null for non-existent sibling
    ok 5 - should return null for non-existent sibling
      ---
      duration_ms: 0.2131
      ...
    1..5
ok 27 - BlockRegistry
  ---
  duration_ms: 9.2619
  type: 'suite'
  ...
# Subtest: BlockRegistryBuilder
    # Subtest: should build registry from simple AST
    ok 1 - should build registry from simple AST
      ---
      duration_ms: 0.3964
      ...
    # Subtest: should build registry from nested AST
    ok 2 - should build registry from nested AST
      ---
      duration_ms: 0.4559
      ...
    # Subtest: should skip Expression properties in Pass 1
    ok 3 - should skip Expression properties in Pass 1
      ---
      duration_ms: 0.4737
      ...
    1..3
ok 28 - BlockRegistryBuilder
  ---
  duration_ms: 1.7774
  type: 'suite'
  ...
# Subtest: ReferenceResolver - $this references
    # Subtest: should resolve $this.property
    ok 1 - should resolve $this.property
      ---
      duration_ms: 1.4048
      ...
    # Subtest: should throw error if $this property not found
    ok 2 - should throw error if $this property not found
      ---
      duration_ms: 1.029
      ...
    1..2
ok 29 - ReferenceResolver - $this references
  ---
  duration_ms: 2.7286
  type: 'suite'
  ...
# Subtest: ReferenceResolver - $parent references
    # Subtest: should resolve $parent.property
    ok 1 - should resolve $parent.property
      ---
      duration_ms: 0.4413
      ...
    # Subtest: should resolve $parent.parent chaining
    ok 2 - should resolve $parent.parent chaining
      ---
      duration_ms: 0.2932
      ...
    # Subtest: should throw error if $parent used on root block
    ok 3 - should throw error if $parent used on root block
      ---
      duration_ms: 0.2306
      ...
    1..3
ok 30 - ReferenceResolver - $parent references
  ---
  duration_ms: 1.1228
  type: 'suite'
  ...
# Subtest: ReferenceResolver - $BlockId references
    # Subtest: should resolve $BlockId.property for sibling
    ok 1 - should resolve $BlockId.property for sibling
      ---
      duration_ms: 0.3094
      ...
    # Subtest: should throw error if sibling block not found
    ok 2 - should throw error if sibling block not found
      ---
      duration_ms: 0.3094
      ...
    1..2
ok 31 - ReferenceResolver - $BlockId references
  ---
  duration_ms: 0.7277
  type: 'suite'
  ...
# Subtest: ReferenceResolver - Complex expressions
    # Subtest: should resolve references in arithmetic expressions
    ok 1 - should resolve references in arithmetic expressions
      ---
      duration_ms: 0.2776
      ...
    # Subtest: should resolve multiple different reference types in one expression
    ok 2 - should resolve multiple different reference types in one expression
      ---
      duration_ms: 0.4015
      ...
    1..2
ok 32 - ReferenceResolver - Complex expressions
  ---
  duration_ms: 0.7947
  type: 'suite'
  ...
# Subtest: ReferenceResolver - Edge cases
    # Subtest: should throw error for incomplete reference (missing property)
    ok 1 - should throw error for incomplete reference (missing property)
      ---
      duration_ms: 0.2655
      ...
    # Subtest: should throw error for invalid reference name
    ok 2 - should throw error for invalid reference name
      ---
      duration_ms: 0.262
      ...
    1..2
ok 33 - ReferenceResolver - Edge cases
  ---
  duration_ms: 0.637
  type: 'suite'
  ...
# Subtest: Tag Registry
    # Subtest: defines and retrieves tags
    ok 1 - defines and retrieves tags
      ---
      duration_ms: 1.3811
      ...
    # Subtest: prevents duplicate tag definitions
    ok 2 - prevents duplicate tag definitions
      ---
      duration_ms: 0.6851
      ...
    # Subtest: registers tag instances
    ok 3 - registers tag instances
      ---
      duration_ms: 0.2827
      ...
    # Subtest: prevents duplicate instance registration
    ok 4 - prevents duplicate instance registration
      ---
      duration_ms: 0.368
      ...
    # Subtest: gets instances for tag name
    ok 5 - gets instances for tag name
      ---
      duration_ms: 0.2924
      ...
    1..5
ok 34 - Tag Registry
  ---
  duration_ms: 4.3992
  type: 'suite'
  ...
# Subtest: Tag Processor
    # Subtest: creates instance keys
    ok 1 - creates instance keys
      ---
      duration_ms: 0.3403
      ...
    # Subtest: detects tag usage types
    ok 2 - detects tag usage types
      ---
      duration_ms: 0.5248
      ...
    # Subtest: throws on mixed tag types
    ok 3 - throws on mixed tag types
      ---
      duration_ms: 0.4311
      ...
    # Subtest: validates tag definitions
    ok 4 - validates tag definitions
      ---
      duration_ms: 0.3613
      ...
    # Subtest: throws on undefined tag
    ok 5 - throws on undefined tag
      ---
      duration_ms: 0.342
      ...
    # Subtest: throws on tag definition with expression
    ok 6 - throws on tag definition with expression
      ---
      duration_ms: 0.2583
      ...
    # Subtest: throws on composition with properties
    ok 7 - throws on composition with properties
      ---
      duration_ms: 0.2446
      ...
    # Subtest: throws on composition with children
    ok 8 - throws on composition with children
      ---
      duration_ms: 0.1603
      ...
    # Subtest: processes tag definitions
    ok 9 - processes tag definitions
      ---
      duration_ms: 1.9838
      ...
    # Subtest: keeps tag definitions when canOutput is true
    ok 10 - keeps tag definitions when canOutput is true
      ---
      duration_ms: 0.2889
      ...
    # Subtest: validates instances reference existing definitions
    ok 11 - validates instances reference existing definitions
      ---
      duration_ms: 0.6352
      ...
    1..11
ok 35 - Tag Processor
  ---
  duration_ms: 6.2334
  type: 'suite'
  ...
# Subtest: Tag Expansion
    # Subtest: expands single tag instance
    ok 1 - expands single tag instance
      ---
      duration_ms: 1.0633
      ...
    # Subtest: expands tag instance with inherited children
    ok 2 - expands tag instance with inherited children
      ---
      duration_ms: 0.8373
      ...
    # Subtest: expands tag composition
    ok 3 - expands tag composition
      ---
      duration_ms: 1.2816
      ...
    # Subtest: expands nested tag instances
    ok 4 - expands nested tag instances
      ---
      duration_ms: 0.3502
      ...
    # Subtest: clones blocks independently
    ok 5 - clones blocks independently
      ---
      duration_ms: 0.3513
      ...
    1..5
ok 36 - Tag Expansion
  ---
  duration_ms: 4.1392
  type: 'suite'
  ...
# Subtest: Module Property Injection
    # Subtest: injects module properties from tag definition
    ok 1 - injects module properties from tag definition
      ---
      duration_ms: 0.6271
      ...
    # Subtest: throws on module property conflict
    ok 2 - throws on module property conflict
      ---
      duration_ms: 0.2765
      ...
    # Subtest: injects module properties with various types
    ok 3 - injects module properties with various types
      ---
      duration_ms: 0.6962
      ...
    # Subtest: injects module properties into nested blocks
    ok 4 - injects module properties into nested blocks
      ---
      duration_ms: 0.4778
      ...
    # Subtest: handles multiple tags with different module properties
    ok 5 - handles multiple tags with different module properties
      ---
      duration_ms: 0.315
      ...
    # Subtest: module properties are called fresh each time
    ok 6 - module properties are called fresh each time
      ---
      duration_ms: 0.172
      ...
    # Subtest: handles empty module definition
    ok 7 - handles empty module definition
      ---
      duration_ms: 0.1057
      ...
    # Subtest: handles blocks without tags
    ok 8 - handles blocks without tags
      ---
      duration_ms: 0.0926
      ...
    # Subtest: module getters receive context with tag information
    ok 9 - module getters receive context with tag information
      ---
      duration_ms: 0.2086
      ...
    # Subtest: module getters support backward compatibility (no context)
    ok 10 - module getters support backward compatibility (no context)
      ---
      duration_ms: 0.1805
      ...
    1..10
ok 37 - Module Property Injection
  ---
  duration_ms: 3.4873
  type: 'suite'
  ...
# Subtest: Critical Fixes
    # Subtest: deep clone prevents shared nested object references
    ok 1 - deep clone prevents shared nested object references
      ---
      duration_ms: 0.4633
      ...
    # Subtest: deep clone handles nested arrays recursively
    ok 2 - deep clone handles nested arrays recursively
      ---
      duration_ms: 0.2561
      ...
    # Subtest: detects circular tag dependencies in direct recursion
    ok 3 - detects circular tag dependencies in direct recursion
      ---
      duration_ms: 0.2861
      ...
    # Subtest: detects circular tag dependencies in indirect recursion
    ok 4 - detects circular tag dependencies in indirect recursion
      ---
      duration_ms: 0.2655
      ...
    # Subtest: allows non-circular recursive structures
    ok 5 - allows non-circular recursive structures
      ---
      duration_ms: 0.3931
      ...
    1..5
ok 38 - Critical Fixes
  ---
  duration_ms: 1.8494
  type: 'suite'
  ...
# Subtest: Template Expansion - <set>
    # Subtest: sets variable with literal value
    ok 1 - sets variable with literal value
      ---
      duration_ms: 3.3303
      ...
    # Subtest: sets variable with expression
    ok 2 - sets variable with expression
      ---
      duration_ms: 1.1193
      ...
    # Subtest: set template produces no blocks
    ok 3 - set template produces no blocks
      ---
      duration_ms: 0.3545
      ...
    # Subtest: sets multiple variables in sequence
    ok 4 - sets multiple variables in sequence
      ---
      duration_ms: 0.3861
      ...
    1..4
ok 39 - Template Expansion - <set>
  ---
  duration_ms: 6.5933
  type: 'suite'
  ...
# Subtest: Template Expansion - <if>
    # Subtest: expands then block when condition is true
    ok 1 - expands then block when condition is true
      ---
      duration_ms: 0.8983
      ...
    # Subtest: does not expand then block when condition is false
    ok 2 - does not expand then block when condition is false
      ---
      duration_ms: 0.2928
      ...
    # Subtest: expands else block when condition is false
    ok 3 - expands else block when condition is false
      ---
      duration_ms: 0.457
      ...
    # Subtest: expands elseif block when condition matches
    ok 4 - expands elseif block when condition matches
      ---
      duration_ms: 1.0112
      ...
    # Subtest: evaluates first matching elseif only
    ok 5 - evaluates first matching elseif only
      ---
      duration_ms: 0.9752
      ...
    # Subtest: handles complex conditions
    ok 6 - handles complex conditions
      ---
      duration_ms: 0.6107
      ...
    # Subtest: expands multiple blocks in branch
    ok 7 - expands multiple blocks in branch
      ---
      duration_ms: 0.4714
      ...
    1..7
ok 40 - Template Expansion - <if>
  ---
  duration_ms: 5.391
  type: 'suite'
  ...
# Subtest: Template Expansion - <foreach>
    # Subtest: expands blocks for each item in array
    ok 1 - expands blocks for each item in array
      ---
      duration_ms: 1.3886
      ...
    # Subtest: makes item available as variable
    ok 2 - makes item available as variable
      ---
      duration_ms: 0.476
      ...
    # Subtest: provides index variable when specified
    ok 3 - provides index variable when specified
      ---
      duration_ms: 0.3084
      ...
    # Subtest: handles empty array
    ok 4 - handles empty array
      ---
      duration_ms: 0.406
      ...
    # Subtest: cleans up item variable after loop
    ok 5 - cleans up item variable after loop
      ---
      duration_ms: 0.2152
      ...
    # Subtest: restores previous item variable value
    ok 6 - restores previous item variable value
      ---
      duration_ms: 0.3538
      ...
    # Subtest: throws on non-array collection
    ok 7 - throws on non-array collection
      ---
      duration_ms: 0.6871
      ...
    1..7
ok 41 - Template Expansion - <foreach>
  ---
  duration_ms: 4.1238
  type: 'suite'
  ...
# Subtest: Template Expansion - <while>
    # Subtest: expands blocks while condition is true
    ok 1 - expands blocks while condition is true
      ---
      duration_ms: 0.5654
      ...
    # Subtest: does not expand when condition is initially false
    ok 2 - does not expand when condition is initially false
      ---
      duration_ms: 0.1872
      ...
    # Subtest: prevents infinite loops with max iterations
    ok 3 - prevents infinite loops with max iterations
      ---
      duration_ms: 30.4248
      ...
    # Subtest: handles complex loop with variable updates
    ok 4 - handles complex loop with variable updates
      ---
      duration_ms: 0.6033
      ...
    1..4
ok 42 - Template Expansion - <while>
  ---
  duration_ms: 31.9775
  type: 'suite'
  ...
# Subtest: Template Expansion - Nested Templates
    # Subtest: handles nested if templates
    ok 1 - handles nested if templates
      ---
      duration_ms: 0.4623
      ...
    # Subtest: handles foreach inside if
    ok 2 - handles foreach inside if
      ---
      duration_ms: 0.345
      ...
    # Subtest: handles if inside foreach
    ok 3 - handles if inside foreach
      ---
      duration_ms: 0.3208
      ...
    # Subtest: handles set inside foreach
    ok 4 - handles set inside foreach
      ---
      duration_ms: 0.2856
      ...
    1..4
ok 43 - Template Expansion - Nested Templates
  ---
  duration_ms: 1.5782
  type: 'suite'
  ...
# Subtest: Template Expansion - Integration
    # Subtest: expands complex template combination
    ok 1 - expands complex template combination
      ---
      duration_ms: 0.6704
      ...
    1..1
ok 44 - Template Expansion - Integration
  ---
  duration_ms: 0.7534
  type: 'suite'
  ...
# Subtest: TemplateExpander - OnData
    # Subtest: expands on-data block with successful fetch
    ok 1 - expands on-data block with successful fetch
      ---
      duration_ms: 5.2165
      ...
    # Subtest: expands on-error block with failed fetch
    ok 2 - expands on-error block with failed fetch
      ---
      duration_ms: 0.6167
      ...
    # Subtest: makes data source result available as variable
    ok 3 - makes data source result available as variable
      ---
      duration_ms: 0.5722
      ...
    # Subtest: makes error available as $error variable
    ok 4 - makes error available as $error variable
      ---
      duration_ms: 0.4769
      ...
    # Subtest: handles nested on-data blocks
    ok 5 - handles nested on-data blocks
      ---
      duration_ms: 0.8244
      ...
    # Subtest: handles multiple parallel on-data blocks
    ok 6 - handles multiple parallel on-data blocks
      ---
      duration_ms: 0.7316
      ...
    # Subtest: handles mixed success and error blocks
    ok 7 - handles mixed success and error blocks
      ---
      duration_ms: 0.9178
      ...
    # Subtest: preserves block children when expanding
    ok 8 - preserves block children when expanding
      ---
      duration_ms: 0.6379
      ...
    # Subtest: handles empty data source results
    ok 9 - handles empty data source results
      ---
      duration_ms: 0.5877
      ...
    # Subtest: cleans up variables after expansion
    ok 10 - cleans up variables after expansion
      ---
      duration_ms: 0.4611
      ...
    # Subtest: cleans up $error variable after expansion
    ok 11 - cleans up $error variable after expansion
      ---
      duration_ms: 0.488
      ...
    # Subtest: handles on-data with no error block when fetch fails
    ok 12 - handles on-data with no error block when fetch fails
      ---
      duration_ms: 0.6727
      ...
    # Subtest: expands multiple levels of nesting
    ok 13 - expands multiple levels of nesting
      ---
      duration_ms: 0.7102
      ...
    1..13
ok 45 - TemplateExpander - OnData
  ---
  duration_ms: 14.6483
  type: 'suite'
  ...
# Subtest: Two-Pass Integration - $parent references
    # Subtest: should resolve $parent.property in nested blocks
    ok 1 - should resolve $parent.property in nested blocks
      ---
      duration_ms: 4.0206
      ...
    # Subtest: should resolve $parent.parent chaining
    ok 2 - should resolve $parent.parent chaining
      ---
      duration_ms: 0.7956
      ...
    # Subtest: should resolve $parent in arithmetic expressions
    ok 3 - should resolve $parent in arithmetic expressions
      ---
      duration_ms: 0.6704
      ...
    1..3
ok 46 - Two-Pass Integration - $parent references
  ---
  duration_ms: 6.7597
  type: 'suite'
  ...
# Subtest: Two-Pass Integration - $this references
    # Subtest: should resolve $this.property
    ok 1 - should resolve $this.property
      ---
      duration_ms: 0.3018
      ...
    1..1
ok 47 - Two-Pass Integration - $this references
  ---
  duration_ms: 0.508
  type: 'suite'
  ...
# Subtest: Two-Pass Integration - $BlockId references
    # Subtest: should resolve sibling block references
    ok 1 - should resolve sibling block references
      ---
      duration_ms: 0.6133
      ...
    # Subtest: should resolve forward references (sibling defined later)
    ok 2 - should resolve forward references (sibling defined later)
      ---
      duration_ms: 0.4995
      ...
    1..2
ok 48 - Two-Pass Integration - $BlockId references
  ---
  duration_ms: 1.4645
  type: 'suite'
  ...
# Subtest: Two-Pass Integration - Complex scenarios
    # Subtest: should handle mixed reference types in one expression
    ok 1 - should handle mixed reference types in one expression
      ---
      duration_ms: 0.4747
      ...
    # Subtest: should handle references with conditional templates
    ok 2 - should handle references with conditional templates
      ---
      duration_ms: 1.1837
      ...
    # Subtest: should resolve references without breaking non-reference expressions
    ok 3 - should resolve references without breaking non-reference expressions
      ---
      duration_ms: 0.762
      ...
    1..3
ok 49 - Two-Pass Integration - Complex scenarios
  ---
  duration_ms: 2.8738
  type: 'suite'
  ...
# Subtest: Two-Pass Integration - Error handling
    # Subtest: should throw error for $parent on root block
    ok 1 - should throw error for $parent on root block
      ---
      duration_ms: 1.5285
      ...
    # Subtest: should throw error for undefined sibling reference
    ok 2 - should throw error for undefined sibling reference
      ---
      duration_ms: 1.2673
      ...
    # Subtest: should throw error for undefined property reference
    ok 3 - should throw error for undefined property reference
      ---
      duration_ms: 0.3694
      ...
    1..3
ok 50 - Two-Pass Integration - Error handling
  ---
  duration_ms: 3.3604
  type: 'suite'
  ...
# Subtest: TreeWalker - Depth-First Traversal
    # Subtest: pre-order traversal visits parent before children
    ok 1 - pre-order traversal visits parent before children
      ---
      duration_ms: 2.2587
      ...
    # Subtest: post-order traversal visits children before parent
    ok 2 - post-order traversal visits children before parent
      ---
      duration_ms: 0.3182
      ...
    # Subtest: pre-order traversal provides correct parent references
    ok 3 - pre-order traversal provides correct parent references
      ---
      duration_ms: 0.3742
      ...
    # Subtest: TreeWalker tracks parent chain correctly
    ok 4 - TreeWalker tracks parent chain correctly
      ---
      duration_ms: 0.2281
      ...
    # Subtest: depth-first traversal handles single node tree
    ok 5 - depth-first traversal handles single node tree
      ---
      duration_ms: 0.1919
      ...
    1..5
ok 51 - TreeWalker - Depth-First Traversal
  ---
  duration_ms: 4.7099
  type: 'suite'
  ...
# Subtest: TreeWalker - Breadth-First Traversal
    # Subtest: breadth-first traversal visits level by level
    ok 1 - breadth-first traversal visits level by level
      ---
      duration_ms: 0.4627
      ...
    # Subtest: breadth-first traversal provides correct parent references
    ok 2 - breadth-first traversal provides correct parent references
      ---
      duration_ms: 0.3576
      ...
    1..2
ok 52 - TreeWalker - Breadth-First Traversal
  ---
  duration_ms: 1.2062
  type: 'suite'
  ...
# Subtest: TreeWalker - Control Flow
    # Subtest: WalkerControl.STOP terminates traversal early
    ok 1 - WalkerControl.STOP terminates traversal early
      ---
      duration_ms: 0.3786
      ...
    # Subtest: WalkerControl.SKIP skips children of current node
    ok 2 - WalkerControl.SKIP skips children of current node
      ---
      duration_ms: 0.3001
      ...
    1..2
ok 53 - TreeWalker - Control Flow
  ---
  duration_ms: 1.0468
  type: 'suite'
  ...
# Subtest: TreeWalker - Filtering
    # Subtest: filter option excludes non-matching nodes
    ok 1 - filter option excludes non-matching nodes
      ---
      duration_ms: 0.4076
      ...
    # Subtest: filter can use parent context for filtering
    ok 2 - filter can use parent context for filtering
      ---
      duration_ms: 0.1998
      ...
    1..2
ok 54 - TreeWalker - Filtering
  ---
  duration_ms: 0.7267
  type: 'suite'
  ...
# Subtest: Utility Functions
    # Subtest: findNode returns first matching node
    ok 1 - findNode returns first matching node
      ---
      duration_ms: 0.2476
      ...
    # Subtest: findNode returns null if no match found
    ok 2 - findNode returns null if no match found
      ---
      duration_ms: 0.1451
      ...
    # Subtest: findAllNodes returns all matching nodes
    ok 3 - findAllNodes returns all matching nodes
      ---
      duration_ms: 0.1832
      ...
    # Subtest: findByTag finds nodes with specific tag
    ok 4 - findByTag finds nodes with specific tag
      ---
      duration_ms: 0.2539
      ...
    # Subtest: findByProperty finds nodes with specific property
    ok 5 - findByProperty finds nodes with specific property
      ---
      duration_ms: 0.1591
      ...
    # Subtest: findByProperty can match property value
    ok 6 - findByProperty can match property value
      ---
      duration_ms: 0.1217
      ...
    1..6
ok 55 - Utility Functions
  ---
  duration_ms: 1.3161
  type: 'suite'
  ...
# Subtest: MacroWalker - Cursor Control
    # Subtest: nextBlock peeks at next node without advancing
    ok 1 - nextBlock peeks at next node without advancing
      ---
      duration_ms: 0.3647
      ...
    # Subtest: invokeWalk allows jumping to specific block
    ok 2 - invokeWalk allows jumping to specific block
      ---
      duration_ms: 0.407
      ...
    # Subtest: back moves cursor backward
    ok 3 - back moves cursor backward
      ---
      duration_ms: 0.2378
      ...
    # Subtest: getRemainingChildren returns children of specific parent
    ok 4 - getRemainingChildren returns children of specific parent
      ---
      duration_ms: 0.1359
      ...
    # Subtest: current returns current block with parent
    ok 5 - current returns current block with parent
      ---
      duration_ms: 0.1346
      ...
    1..5
ok 56 - MacroWalker - Cursor Control
  ---
  duration_ms: 1.46
  type: 'suite'
  ...
# Subtest: MacroWalker - Auto-processing
    # Subtest: MacroWalker processes all blocks in flattened order
    ok 1 - MacroWalker processes all blocks in flattened order
      ---
      duration_ms: 0.2173
      ...
    # Subtest: MacroWalker stop method halts traversal
    ok 2 - MacroWalker stop method halts traversal
      ---
      duration_ms: 0.2041
      ...
    1..2
ok 57 - MacroWalker - Auto-processing
  ---
  duration_ms: 0.5491
  type: 'suite'
  ...
# Subtest: Edge Cases and Integration
    # Subtest: getAncestors returns correct ancestor chain
    ok 1 - getAncestors returns correct ancestor chain
      ---
      duration_ms: 0.3514
      ...
    # Subtest: getAncestors returns empty array for root node
    ok 2 - getAncestors returns empty array for root node
      ---
      duration_ms: 0.1245
      ...
    # Subtest: walk handles empty children array
    ok 3 - walk handles empty children array
      ---
      duration_ms: 0.1517
      ...
    # Subtest: walk handles null tree gracefully
    ok 4 - walk handles null tree gracefully
      ---
      duration_ms: 0.1233
      ...
    # Subtest: filter with SKIP control works correctly
    ok 5 - filter with SKIP control works correctly
      ---
      duration_ms: 0.9209
      ...
    # Subtest: MacroWalker peekNext returns null at end
    ok 6 - MacroWalker peekNext returns null at end
      ---
      duration_ms: 0.1559
      ...
    # Subtest: complex tree traversal with mixed controls
    ok 7 - complex tree traversal with mixed controls
      ---
      duration_ms: 0.1503
      ...
    1..7
ok 58 - Edge Cases and Integration
  ---
  duration_ms: 2.2326
  type: 'suite'
  ...
1..58
# tests 307
# suites 63
# pass 305
# fail 2
# cancelled 0
# skipped 0
# todo 0
# duration_ms 413.7969
